Implement DML commands like Insertion, Deletion, Modifying, Altering, and Updating records based on conditions.*
Consider the employee database given below
  emp (emp_id,emp_name, Street_No, city)
  works (emp_id, company name, salary)
  company (company name, city)
  manages (emp_id, manager_id)  

Note: Emp_id should start with ‘E’ in Emp table and emp_id in works table must be the emp_id from emptable .emp_id and manager_id in manages table must be the emp_id from emp table.

· Add these four tables with sufficient constraints.
· Alter table emp add a constraint that emp_name cannot be null
· Find the names of all employees who work for SBI.
· Find all employees in the database who live in the same cities as the companies for which they work.
· Find all employees and their managers in the database who live in the same cities and on the same street number as do their managers.
· Find all employees who earn more than the average salary of all employees of their company.
· Find the company that pay least total salary along with the salary paid.
· Give all managers of SBI a 10 percent raise.
· Find the company that has the most employees
· Find those companies whose employees earn a higher salary, on average than the average salary at Indian Bank.

Query to find the name and salary of all employees who earn more than each employee of ‘Indian Bank’

mysql> create database Works;

mysql> use Works;

mysql> CREATE TABLE emp (
    ->     emp_id VARCHAR(10) PRIMARY KEY,
    ->     emp_name VARCHAR(50) NOT NULL,
    ->     Street_No INT,
    ->     city VARCHAR(50)
    -> );

mysql> CREATE TABLE works (
    ->     emp_id VARCHAR(10) PRIMARY KEY,
    ->     company_name VARCHAR(50),
    ->     salary DECIMAL(10,2),
    ->     FOREIGN KEY (emp_id) REFERENCES emp(emp_id)
    -> );

mysql> CREATE TABLE company (
    ->     company_name VARCHAR(50) PRIMARY KEY,
    ->     city VARCHAR(50)
    -> );

mysql> CREATE TABLE manages (
    ->     emp_id VARCHAR(10),
    ->     manager_id VARCHAR(10),
    ->     PRIMARY KEY (emp_id, manager_id),
    ->     FOREIGN KEY (emp_id) REFERENCES emp(emp_id),
    ->     FOREIGN KEY (manager_id) REFERENCES emp(emp_id)
    -> );

mysql> INSERT INTO emp VALUES
    -> ('E001', 'Rabeah', 34, 'Calicut'),
    -> ('E002', 'Karthik', 78, 'Kannur'),
    -> ('E003', 'Joseph', 19, 'Ernakulam'),
    -> ('E004', 'Thejus', 77, 'Thrissur'),
    -> ('E005', 'Amal', 56, 'Malappuram');

mysql> INSERT INTO works VALUES
    -> ('E001', 'SBI', 50000),
    -> ('E002', 'ICICI', 60000),
    -> ('E003', 'HDFC', 55000),
    -> ('E004', 'SBI', 48000),
    -> ('E005', 'ICICI', 52000);

mysql> INSERT INTO company VALUES
    -> ('SBI', 'Mumbai'),
    -> ('ICICI', 'Delhi'),
    -> ('HDFC', 'Chennai'),
    -> ('Axis', 'Bangalore');

mysql> INSERT INTO manages VALUES
    -> ('E002', 'E001'),
    -> ('E003', 'E001'),
    -> ('E004', 'E002'),
    -> ('E005', 'E002');

mysql> ALTER TABLE emp ADD CONSTRAINT emp_name_not_null CHECK (emp_name IS NOT NULL);
mysql> desc emp;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| emp_id    | varchar(10) | NO   | PRI | NULL    |       |
| emp_name  | varchar(50) | NO   |     | NULL    |       |
| Street_No | int(11)     | YES  |     | NULL    |       |
| city      | varchar(50) | YES  |     | NULL    |       |
+-----------+-------------+------+-----+---------+-------+

mysql> SELECT e.emp_name
    -> FROM emp e
    -> INNER JOIN works w ON e.emp_id = w.emp_id
    -> WHERE w.company_name = 'SBI';
+----------+
| emp_name |
+----------+
| Rabeah   |
| Thejus   |
+----------+

mysql> desc emp;
+-----------+-------------+------+-----+---------+-------+
| Field     | Type        | Null | Key | Default | Extra |
+-----------+-------------+------+-----+---------+-------+
| emp_id    | varchar(10) | NO   | PRI | NULL    |       |
| emp_name  | varchar(50) | NO   |     | NULL    |       |
| Street_No | int(11)     | YES  |     | NULL    |       |
| city      | varchar(50) | YES  |     | NULL    |       |
+-----------+-------------+------+-----+---------+-------+
4 rows in set (0.00 sec)

mysql> SELECT e.emp_name, e.city
    -> FROM emp e
    -> INNER JOIN works w ON e.emp_id = w.emp_id
    -> INNER JOIN company c ON w.company_name = c.company_name
    -> WHERE e.city = c.city;
Empty set (0.02 sec)

mysql> desc works, company, managers;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' company, managers' at line 1
mysql> desc works;
+--------------+---------------+------+-----+---------+-------+
| Field        | Type          | Null | Key | Default | Extra |
+--------------+---------------+------+-----+---------+-------+
| emp_id       | varchar(10)   | NO   | PRI | NULL    |       |
| company_name | varchar(50)   | YES  |     | NULL    |       |
| salary       | decimal(10,2) | YES  |     | NULL    |       |
+--------------+---------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

mysql> desc company;
+--------------+-------------+------+-----+---------+-------+
| Field        | Type        | Null | Key | Default | Extra |
+--------------+-------------+------+-----+---------+-------+
| company_name | varchar(50) | NO   | PRI | NULL    |       |
| city         | varchar(50) | YES  |     | NULL    |       |
+--------------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> desc managers;
ERROR 1146 (42S02): Table 'Works.managers' doesn't exist
mysql> desc manager;
ERROR 1146 (42S02): Table 'Works.manager' doesn't exist
mysql> desc manages;
+------------+-------------+------+-----+---------+-------+
| Field      | Type        | Null | Key | Default | Extra |
+------------+-------------+------+-----+---------+-------+
| emp_id     | varchar(10) | NO   | PRI | NULL    |       |
| manager_id | varchar(10) | NO   | PRI | NULL    |       |
+------------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

mysql> UPDATE TABLE works SET city = 'Banglore' WHERE emp_id = 'E005';
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'TABLE works SET city = 'Banglore' WHERE emp_id = 'E005'' at line 1
mysql> UPDATE works SET city = 'Banglore' WHERE emp_id = 'E005';
ERROR 1054 (42S22): Unknown column 'city' in 'field list'
mysql> UPDATE company SET city = 'Banglore' WHERE emp_id = 'E005';
ERROR 1054 (42S22): Unknown column 'emp_id' in 'where clause'
mysql> UPDATE emp SET city = 'Banglore' WHERE emp_id = 'E005';
Query OK, 1 row affected (0.06 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from emp;
+--------+----------+-----------+-----------+
| emp_id | emp_name | Street_No | city      |
+--------+----------+-----------+-----------+
| E001   | Rabeah   |        34 | Calicut   |
| E002   | Karthik  |        78 | Kannur    |
| E003   | Joseph   |        19 | Ernakulam |
| E004   | Thejus   |        77 | Thrissur  |
| E005   | Amal     |        56 | Banglore  |
+--------+----------+-----------+-----------+
5 rows in set (0.00 sec)

mysql> SELECT e.emp_name, e.city FROM emp e INNER JOIN works w ON e.emp_id = w.emp_id INNER JOIN company c ON w.company_name = c.company_name WHERE e.city = c.city;
Empty set (0.00 sec)

mysql> select e.emp_name, e.city from emp e, work 
    -> ;
ERROR 1146 (42S02): Table 'Works.work' doesn't exist
mysql> select * from emp;
+--------+----------+-----------+-----------+
| emp_id | emp_name | Street_No | city      |
+--------+----------+-----------+-----------+
| E001   | Rabeah   |        34 | Calicut   |
| E002   | Karthik  |        78 | Kannur    |
| E003   | Joseph   |        19 | Ernakulam |
| E004   | Thejus   |        77 | Thrissur  |
| E005   | Amal     |        56 | Banglore  |
+--------+----------+-----------+-----------+
5 rows in set (0.00 sec)

mysql> select * from works;
+--------+--------------+----------+
| emp_id | company_name | salary   |
+--------+--------------+----------+
| E001   | SBI          | 50000.00 |
| E002   | ICICI        | 60000.00 |
| E003   | HDFC         | 55000.00 |
| E004   | SBI          | 48000.00 |
| E005   | ICICI        | 52000.00 |
+--------+--------------+----------+
5 rows in set (0.00 sec)

mysql> select * from company;
+--------------+-----------+
| company_name | city      |
+--------------+-----------+
| Axis         | Bangalore |
| HDFC         | Chennai   |
| ICICI        | Delhi     |
| SBI          | Mumbai    |
+--------------+-----------+
4 rows in set (0.00 sec)

mysql> select * from manages;
+--------+------------+
| emp_id | manager_id |
+--------+------------+
| E002   | E001       |
| E003   | E001       |
| E004   | E002       |
| E005   | E002       |
+--------+------------+
4 rows in set (0.00 sec)

mysql> UPDATE works SET company_name = 'AXIS' WHERE emp_id = 'E002';
Query OK, 1 row affected (0.06 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from works;
+--------+--------------+----------+
| emp_id | company_name | salary   |
+--------+--------------+----------+
| E001   | SBI          | 50000.00 |
| E002   | AXIS         | 60000.00 |
| E003   | HDFC         | 55000.00 |
| E004   | SBI          | 48000.00 |
| E005   | ICICI        | 52000.00 |
+--------+--------------+----------+
5 rows in set (0.00 sec)

mysql> UPDATE works SET company_name = 'Axis' WHERE emp_id = 'E002';
Query OK, 1 row affected (0.05 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from works;
+--------+--------------+----------+
| emp_id | company_name | salary   |
+--------+--------------+----------+
| E001   | SBI          | 50000.00 |
| E002   | Axis         | 60000.00 |
| E003   | HDFC         | 55000.00 |
| E004   | SBI          | 48000.00 |
| E005   | ICICI        | 52000.00 |
+--------+--------------+----------+
5 rows in set (0.00 sec)

mysql> SELECT e.emp_name, e.city FROM emp e INNER JOIN works w ON e.emp_id = w.emp_id INNER JOIN company c ON w.company_name = c.company_name WHERE e.city = c.city;
Empty set (0.00 sec)
